<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Sniper J GM æ¨¡æ“¬å™¨ v0.4</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f2f2f2; }
    h1 { color: #2c3e50; }
    button { margin: 5px; padding: 10px; font-size: 16px; border-radius: 5px; }
    .player { background: white; margin: 10px 0; padding: 10px; border-radius: 6px; }
    .section { margin-top: 30px; }
    select { padding: 5px 10px; margin-top: 10px; }
    .disabled { opacity: 0.5; pointer-events: none; }
    #dayInfo { margin-top: 20px; font-weight: bold; }
  </style>
</head>
<body>
  <h1>ğŸ€ Sniper J GM æ¨¡æ“¬å™¨ v0.4</h1>
  <div class="section">
    <button id="btnShowWarriors">é¡¯ç¤ºå‹‡å£«éšŠçƒå“¡</button>
    <button id="btnShowFA">è‡ªç”±å¸‚å ´</button>
    <button id="btnSelectTeam">æŸ¥çœ‹å…¶ä»–éšŠä¼</button>
    <button id="btnSimGame">æ¨¡æ“¬æ¯”è³½</button>
    <button id="btnNextDay">â¡ï¸ éä¸€å¤©</button>
    <div id="dayInfo"></div>
    <div id="teamSelectArea"></div>
  </div>

  <div id="team"></div>
  <div id="freeAgents"></div>
  <div id="otherTeam"></div>
  <div id="gameResult"></div>

<script>
let day = 1;
let trainLimit = 3;

const warriors = [
  { name: "Stephen Curry", rating: "S", trained: false },
  { name: "Klay Thompson", rating: "B+", trained: false },
  { name: "Draymond Green", rating: "B", trained: false },
  { name: "Jonathan Kuminga", rating: "B", trained: false },
  { name: "Andrew Wiggins", rating: "B+", trained: false },
  { name: "Moses Moody", rating: "C+", trained: false }
];

const freeAgents = [
  { name: "Malik Beasley", rating: "B", signChance: 60 },
  { name: "Robert Covington", rating: "B-", signChance: 50 },
  { name: "Will Barton", rating: "C+", signChance: 80 },
  { name: "Kelly Oubre Jr.", rating: "B", signChance: 70 }
];

const otherTeams = {
  "é›·éœ†": [
    { name: "Shai Gilgeous-Alexander", rating: "S" },
    { name: "Jalen Williams", rating: "A" },
    { name: "Chet Holmgren", rating: "A-" }
  ],
  "ç°ç‹¼": [
    { name: "Anthony Edwards", rating: "S" },
    { name: "Rudy Gobert", rating: "B+" },
    { name: "Karl-Anthony Towns", rating: "A" }
  ],
  "é‡‘å¡Š": [
    { name: "Nikola Jokic", rating: "S+" },
    { name: "Jamal Murray", rating: "A" },
    { name: "Aaron Gordon", rating: "B+" }
  ]
};

function updateDayInfo() {
  document.getElementById("dayInfo").innerText = `ğŸ“… ç¬¬ ${day} å¤©ï½œå‰©é¤˜è¨“ç·´æ¬¡æ•¸ï¼š${trainLimit}`;
}

function showWarriors() {
  const container = document.getElementById("team");
  container.innerHTML = "<h2>å‹‡å£«éšŠé™£å®¹</h2>";
  warriors.forEach((player, index) => {
    const trainedClass = player.trained ? 'disabled' : '';
    const trainedText = player.trained ? 'ï¼ˆå·²è¨“ç·´ï¼‰' : '';
    const disableTrain = player.trained || trainLimit <= 0 ? 'disabled' : '';
    container.innerHTML += `
      <div class="player">
        <strong>${player.name}</strong> - è©•åƒ¹ï¼š${player.rating} ${trainedText}<br />
        <button class="trainBtn" data-index="${index}" ${disableTrain}>è¨“ç·´</button>
        <button class="tradeBtn" data-index="${index}">äº¤æ˜“ä»–éšŠçƒå“¡</button>
      </div>
    `;
  });
}

function showFreeAgents() {
  const container = document.getElementById("freeAgents");
  container.innerHTML = "<h2>å¯ç°½è‡ªç”±çƒå“¡</h2>";
  freeAgents.forEach((player, index) => {
    container.innerHTML += `
      <div class="player">
        <strong>${player.name}</strong> - è©•åƒ¹ï¼š${player.rating}ï¼ˆç°½ç´„æ©Ÿç‡ ${player.signChance}%ï¼‰<br />
        <button class="signBtn" data-index="${index}">ç°½ä¸‹</button>
      </div>
    `;
  });
}

function selectTeam() {
  const area = document.getElementById("teamSelectArea");
  area.innerHTML = `
    <h2>é¸æ“‡ä¸€æ”¯çƒéšŠï¼š</h2>
    <select id="teamSelect">
      <option value="">è«‹é¸æ“‡</option>
      ${Object.keys(otherTeams).map(t => `<option value="${t}">${t}</option>`).join("")}
    </select>
  `;
  document.getElementById("teamSelect").addEventListener("change", e => {
    showOtherTeam(e.target.value);
  });
}

function showOtherTeam(teamName) {
  const container = document.getElementById("otherTeam");
  if (!teamName) return container.innerHTML = '';
  const players = otherTeams[teamName];
  container.innerHTML = `<h2>${teamName} çƒå“¡</h2>`;
  players.forEach((player, index) => {
    container.innerHTML += `
      <div class="player">
        <strong>${player.name}</strong> - è©•åƒ¹ï¼š${player.rating}<br />
        <button class="proposeTrade" data-team="${teamName}" data-index="${index}">ç™¼èµ·äº¤æ˜“</button>
      </div>
    `;
  });
}

function trainPlayer(index) {
  if (warriors[index].trained || trainLimit <= 0) return;
  const ratings = ["C", "C+", "B-", "B", "B+", "A-", "A", "A+", "S", "S+"];
  let idx = ratings.indexOf(warriors[index].rating);
  if (idx < ratings.length - 1) {
    warriors[index].rating = ratings[idx + 1];
    warriors[index].trained = true;
    trainLimit--;
    alert(`${warriors[index].name} è¨“ç·´æˆåŠŸï¼å‡ç‚º ${warriors[index].rating}`);
  } else {
    alert(`${warriors[index].name} å·²é”æœ€é«˜è©•åƒ¹ï¼`);
  }
  showWarriors();
  updateDayInfo();
}

function signPlayer(index) {
  const chance = freeAgents[index].signChance;
  const rand = Math.random() * 100;
  if (rand <= chance) {
    warriors.push({ ...freeAgents[index], trained: false });
    alert(`${freeAgents[index].name} åŠ å…¥å‹‡å£«ï¼`);
    freeAgents.splice(index, 1);
  } else {
    alert(`${freeAgents[index].name} æ‹’çµ•ç°½ç´„ã€‚`);
  }
  showFreeAgents();
  showWarriors();
}

function proposeTrade(team, index) {
  const otherPlayer = otherTeams[team][index];
  const warriorNames = warriors.map(w => w.name).join("\n");
  const input = prompt(`ä½ è¦ç”¨å“ªä½å‹‡å£«çƒå“¡æ› ${otherPlayer.name}ï¼Ÿ\nè«‹è¼¸å…¥åç¨±ï¼š\n${warriorNames}`);
  const warriorIndex = warriors.findIndex(p => p.name === input);
  if (warriorIndex >= 0) {
    const traded = warriors[warriorIndex];
    warriors[warriorIndex] = otherPlayer;
    otherTeams[team][index] = traded;
    alert(`äº¤æ˜“æˆåŠŸï¼ä½ ç”¨ ${traded.name} æ›ä¾† ${otherPlayer.name}`);
    showWarriors();
    showOtherTeam(team);
  } else {
    alert("æ‰¾ä¸åˆ°è©²å‹‡å£«çƒå“¡ï¼");
  }
}

function simulateGame() {
  const ratingToScore = {
    "C": 5, "C+": 7, "B-": 9, "B": 10, "B+": 12,
    "A-": 14, "A": 15, "A+": 17, "S": 18, "S+": 20
  };
  const teams = Object.keys(otherTeams);
  const opponentName = teams[Math.floor(Math.random() * teams.length)];
  const opponent = otherTeams[opponentName];

  let ourScore = 0, oppScore = 0, mvp = "", maxScore = -1;

  warriors.forEach(p => {
    let score = ratingToScore[p.rating] + Math.floor(Math.random() * 6);
    ourScore += score;
    if (score > maxScore) { mvp = p.name; maxScore = score; }
  });

  opponent.forEach(p => {
    oppScore += ratingToScore[p.rating] + Math.floor(Math.random() * 6);
  });

  const result = document.getElementById("gameResult");
  result.innerHTML = `<h2>æ¯”è³½çµæœ ğŸ€</h2>
    <p>å‹‡å£« vs ${opponentName}</p>
    <p>æ¯”åˆ†ï¼š${ourScore} - ${oppScore}</p>
    <p>${ourScore > oppScore ? "ğŸ‰ å‹‡å£«å‹åˆ©ï¼" : "ğŸ˜¢ å‹‡å£«è½æ•—..."}</p>
    <p>MVPï¼š${mvp}ï¼ˆå¾—åˆ† ${maxScore}ï¼‰</p>
  `;
}

function nextDay() {
  day++;
  trainLimit = 3;
  warriors.forEach(p => p.trained = false);
  alert("å·²é€²å…¥æ–°çš„ä¸€å¤©ï¼");
  updateDayInfo();
  showWarriors();
}

function initButtons() {
  document.getElementById("btnShowWarriors").addEventListener("click", showWarriors);
  document.getElementById("btnShowFA").addEventListener("click", showFreeAgents);
  document.getElementById("btnSelectTeam").addEventListener("click", selectTeam);
  document.getElementById("btnSimGame").addEventListener("click", simulateGame);
  document.getElementById("btnNextDay").addEventListener("click", nextDay);
}

function bindDynamicButtons() {
  document.addEventListener("click", function (e) {
    if (e.target.classList.contains("trainBtn")) {
      const i = e.target.dataset.index;
      trainPlayer(i);
    }
    if (e.target.classList.contains("signBtn")) {
      const i = e.target.dataset.index;
      signPlayer(i);
    }
    if (e.target.classList.contains("proposeTrade")) {
      const team = e.target.dataset.team;
      const i = e.target.dataset.index;
      proposeTrade(team, i);
    }
  });
}

window.onload = () => {
  updateDayInfo();
  initButtons();
  bindDynamicButtons();
};
</script>
</body>
</html>
