<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Sniper J GM æ¨¡æ“¬å™¨ v0.7.1.1</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f2f2f2; }
    h1 { color: #2c3e50; }
    button { margin: 5px; padding: 10px; font-size: 16px; border-radius: 5px; cursor: pointer; }
    .player { background: white; margin: 10px 0; padding: 10px; border-radius: 6px; display: flex; align-items: center; }
    .player-card { width: 60px; height: 60px; background: #eee; margin-right: 10px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .section { margin-top: 30px; }
    select { padding: 5px 10px; margin-top: 10px; }
    .disabled { opacity: 0.5; pointer-events: none; }
    .stats { font-size: 12px; color: #555; margin-left: auto; text-align: right; }
    .container { max-width: 800px; margin: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ€ Sniper J GM æ¨¡æ“¬å™¨ v0.7.1.1</h1>
    <div><button id="clearBtn">æ¸…ç©ºå­˜æª”</button>ï½œ<span id="dateDisplay"></span></div>
    <div class="section">
      <button id="showWarriorsBtn">å‹‡å£«é™£å®¹</button>
      <button id="showFreeAgentsBtn">è‡ªç”±å¸‚å ´</button>
      <button id="selectTeamBtn">å…¶ä»–éšŠä¼</button>
      <button id="simulateGameBtn">æ¨¡æ“¬æ¯”è³½</button>
      <button id="resetTrainingBtn">é‡ç½®è¨“ç·´</button>
      <div id="teamSelectArea"></div>
    </div>
    <div id="team"></div>
    <div id="freeAgents"></div>
    <div id="otherTeam"></div>
    <div id="gameResult"></div>
    <div id="logs"></div>
  </div>

<script>
(function() {
  let warriors, freeAgents, otherTeams, money, salaryCap, lastSimDate;

  const ratingMap = {
    "C": 1, "C+": 2, "B-": 3, "B": 4, "B+": 5,
    "A-": 6, "A": 7, "A+": 8, "S": 9, "S+": 10
  };

  const otherTeamData = {
    "é›·éœ†": [
      { name: "Shai Gilgeous-Alexander", rating: "S" },
      { name: "Jalen Williams", rating: "A" },
      { name: "Chet Holmgren", rating: "A-" }
    ],
    "ç°ç‹¼": [
      { name: "Anthony Edwards", rating: "S" },
      { name: "Rudy Gobert", rating: "B+" },
      { name: "Karl-Anthony Towns", rating: "A" }
    ],
    "é‡‘å¡Š": [
      { name: "Nikola Jokic", rating: "S+" },
      { name: "Jamal Murray", rating: "A" },
      { name: "Aaron Gordon", rating: "B+" }
    ]
  };

  function loadData() {
    const saved = JSON.parse(localStorage.getItem("sj_gm_data") || "null");
    if (saved) {
      ({ warriors, freeAgents, otherTeams, money, salaryCap, lastSimDate } = saved);
    } else {
      money = 100;
      salaryCap = 120;
      lastSimDate = null;
      warriors = [
        { name: "Stephen Curry", rating: "S", trainedToday: false },
        { name: "Klay Thompson", rating: "B+", trainedToday: false },
        { name: "Draymond Green", rating: "B", trainedToday: false },
        { name: "Jonathan Kuminga", rating: "B", trainedToday: false },
        { name: "Andrew Wiggins", rating: "B+", trainedToday: false }
      ];
      freeAgents = [
        { name: "Malik Beasley", rating: "B", signChance: 60 },
        { name: "Robert Covington", rating: "B-", signChance: 50 }
      ];
      otherTeams = structuredClone(otherTeamData);
    }
  }

  function saveData() {
    localStorage.setItem("sj_gm_data", JSON.stringify({ warriors, freeAgents, otherTeams, money, salaryCap, lastSimDate }));
  }

  function renderDate() {
    const now = new Date().toLocaleDateString();
    document.getElementById("dateDisplay").textContent = "ä»Šå¤©ï¼š" + now;
  }

  function showWarriors() {
    const container = document.getElementById("team");
    container.innerHTML = "<h2>å‹‡å£«éšŠé™£å®¹</h2>";
    warriors.forEach((player, i) => {
      const star = "â­".repeat(ratingMap[player.rating]);
      const trainedText = player.trainedToday ? "ï¼ˆå·²è¨“ç·´ï¼‰" : "";
      const btnTrain = player.trainedToday ? `<button class="disabled">è¨“ç·´</button>` : `<button onclick="trainPlayer(${i})">è¨“ç·´</button>`;
      container.innerHTML += `
        <div class="player">
          <div class="player-card">${player.name[0]}</div>
          <div>
            <strong>${player.name}</strong> - ${player.rating} ${trainedText}<br>
            ${star}
          </div>
          <div class="stats">å·¥è³‡ï¼š10M</div>
        </div>
        ${btnTrain}
      `;
    });
  }

  window.trainPlayer = function(i) {
    if (warriors[i].trainedToday) {
      alert("ä»Šæ—¥å·²è¨“ç·´ï¼");
      return;
    }
    const ratingList = Object.keys(ratingMap);
    let current = warriors[i].rating;
    let idx = ratingList.indexOf(current);
    if (idx < ratingList.length - 1) {
      warriors[i].rating = ratingList[idx + 1];
      warriors[i].trainedToday = true;
      alert(`${warriors[i].name} è©•åƒ¹æå‡ç‚º ${warriors[i].rating}ï¼`);
    } else {
      alert("å·²é”æœ€é«˜è©•åƒ¹ï¼");
    }
    showWarriors();
    saveData();
  };

  function resetTraining() {
    warriors.forEach(p => p.trainedToday = false);
    alert("è¨“ç·´é‡ç½®å®Œç•¢ï¼");
    showWarriors();
    saveData();
  }

  function simulateGameAuto(todayStr) {
    let score = 0;
    warriors.forEach(p => {
      score += ratingMap[p.rating] + Math.floor(Math.random() * 6);
    });
    const opponentTeams = Object.entries(otherTeams);
    const [oppName, oppPlayers] = opponentTeams[Math.floor(Math.random() * opponentTeams.length)];
    let oppScore = 0;
    oppPlayers.forEach(p => {
      oppScore += ratingMap[p.rating] + Math.floor(Math.random() * 6);
    });
    const result = document.getElementById("gameResult");
    result.innerHTML = `<h3>æ¯”è³½çµæœ</h3><p>å‹‡å£« ${score} : ${oppScore} ${oppName}</p><p>${score > oppScore ? "ğŸ‰ å‹åˆ©ï¼" : "ğŸ’” è½æ•—..."}</p>`;
    lastSimDate = todayStr;
    saveData();
  }

  function showFreeAgents() {
    const container = document.getElementById("freeAgents");
    container.innerHTML = "<h2>è‡ªç”±çƒå“¡</h2>";
    freeAgents.forEach((fa, i) => {
      const chance = fa.signChance - Math.floor(ratingMap[fa.rating] / 2);
      container.innerHTML += `
        <div class="player">
          <div class="player-card">${fa.name[0]}</div>
          <div><strong>${fa.name}</strong> - è©•åƒ¹ï¼š${fa.rating}<br/>ç°½ç´„æ©Ÿç‡ï¼šç´„ ${chance}%</div>
          <button onclick="signFreeAgent(${i}, ${chance})">ç°½ä¸‹</button>
        </div>
      `;
    });
  }

  window.signFreeAgent = function(index, chance) {
    const rand = Math.random() * 100;
    if (rand <= chance) {
      warriors.push({ ...freeAgents[index], trainedToday: false });
      alert(`${freeAgents[index].name} åŠ å…¥å‹‡å£«ï¼`);
      freeAgents.splice(index, 1);
    } else {
      alert("ç°½ç´„å¤±æ•—ï¼");
    }
    showFreeAgents();
    showWarriors();
    saveData();
  };

  function selectTeam() {
    const area = document.getElementById("teamSelectArea");
    area.innerHTML = `
      <h3>é¸æ“‡éšŠä¼ï¼š</h3>
      <select id="teamSelect">
        <option value="">è«‹é¸æ“‡</option>
        ${Object.keys(otherTeams).map(t => `<option value="${t}">${t}</option>`).join("")}
      </select>
    `;
    document.getElementById("teamSelect").addEventListener("change", e => {
      const team = e.target.value;
      if (team) showOtherTeam(team);
    });
  }

  function showOtherTeam(name) {
    const players = otherTeams[name];
    const container = document.getElementById("otherTeam");
    container.innerHTML = `<h2>${name} é™£å®¹</h2>`;
    players.forEach(p => {
      const star = "â­".repeat(ratingMap[p.rating]);
      container.innerHTML += `<div class="player">
        <div class="player-card">${p.name[0]}</div>
        <div><strong>${p.name}</strong> - è©•åƒ¹ï¼š${p.rating}<br>${star}</div>
      </div>`;
    });
  }

  document.addEventListener("DOMContentLoaded", () => {
    loadData();
    renderDate();
    showWarriors();
    showFreeAgents();

    document.getElementById("showWarriorsBtn").addEventListener("click", showWarriors);
    document.getElementById("showFreeAgentsBtn").addEventListener("click", showFreeAgents);
    document.getElementById("simulateGameBtn").addEventListener("click", () => {
      const todayStr = new Date().toLocaleDateString();
      if (lastSimDate === todayStr) {
        alert("ä»Šå¤©å·²æ¨¡æ“¬éï¼");
      } else {
        simulateGameAuto(todayStr);
      }
    });
    document.getElementById("selectTeamBtn").addEventListener("click", selectTeam);
    document.getElementById("resetTrainingBtn").addEventListener("click", resetTraining);
    document.getElementById("clearBtn").addEventListener("click", () => {
      if (confirm("ç¢ºèªæ¸…é™¤æ‰€æœ‰è³‡æ–™ï¼Ÿ")) {
        localStorage.removeItem("sj_gm_data");
        location.reload();
      }
    });
  });
})();
</script>
</body>
</html>