<!DOCTYPE html>
<html lang="zh-Hant">
<head>
  <meta charset="UTF-8" />
  <title>Sniper J GM æ¨¡æ“¬å™¨ v0.7.2</title>
  <style>
    body { font-family: sans-serif; padding: 20px; background: #f2f2f2; }
    h1 { color: #2c3e50; }
    button { margin: 5px; padding: 10px; font-size: 16px; border-radius: 5px; cursor: pointer; }
    .player { background: white; margin: 10px 0; padding: 10px; border-radius: 6px; display: flex; align-items: center; }
    .player-card { width: 50px; height: 50px; background: #eee; margin-right: 10px; border-radius: 4px; display: flex; align-items: center; justify-content: center; font-weight: bold; }
    .section { margin-top: 20px; }
    select { padding: 5px 10px; margin-top: 10px; }
    .disabled { opacity: 0.5; pointer-events: none; }
    #salaryInfo { margin-top: 10px; font-weight: bold; color: #2c3e50; }
    .container { max-width: 800px; margin: auto; }
  </style>
</head>
<body>
  <div class="container">
    <h1>ğŸ€ Sniperâ€¯J GM æ¨¡æ“¬å™¨ v0.7.2</h1>
    <div>
      <button id="clearBtn">æ¸…ç©ºå­˜æª”</button>
      <span id="dateDisplay"></span>
    </div>
    <div class="section">
      <button id="showWarriorsBtn">å‹‡å£«é™£å®¹</button>
      <button id="showFreeAgentsBtn">è‡ªç”±å¸‚å ´</button>
      <button id="selectTeamBtn">å…¶ä»–éšŠä¼</button>
      <button id="simulateGameBtn">æ¨¡æ“¬æ¯”è³½</button>
      <button id="resetTrainingBtn">é‡ç½®è¨“ç·´</button>
      <div id="teamSelectArea"></div>
    </div>
    <div id="salaryInfo"></div>
    <div id="team"></div>
    <div id="freeAgents"></div>
    <div id="otherTeam"></div>
    <div id="gameResult"></div>
    <div id="logs"></div>
  </div>

  <script>
  (function(){
    let warriors, freeAgents, otherTeams, money, salaryCap, lastSimDate;
    const ratingMap = { "C":1,"C+":2,"B-":3,"B":4,"B+":5,"A-":6,"A":7,"A+":8,"S":9,"S+":10 };
    const baseWage = 10;  // æ¯å€‹ "â­" ç‚ºåŸºæœ¬è–ªè³‡å–®ä½

    const otherTeamData = {
      "é›·éœ†":[{name:"Shai Gilgeous-Alexander",rating:"S"},{name:"Jalen Williams",rating:"A"},{name:"Chet Holmgren",rating:"A-"}],
      "ç°ç‹¼":[{name:"Anthony Edwards",rating:"S"},{name:"Rudy Gobert",rating:"B+"},{name:"Karl-Anthony Towns",rating:"A"}],
      "é‡‘å¡Š":[{name:"Nikola Jokic",rating:"S+"},{name:"Jamal Murray",rating:"A"},{name:"Aaron Gordon",rating:"B+"}]
    };

    function loadData(){
      const s = JSON.parse(localStorage.getItem("sj_gm_data")||"null");
      if(s){
        ({warriors,freeAgents,otherTeams,money,salaryCap,lastSimDate}=s);
      } else {
        money = 100; salaryCap = 120; lastSimDate = null;
        warriors = [
          {name:"Stephen Curry",rating:"S",trainedToday:false},
          {name:"Klay Thompson",rating:"B+",trainedToday:false},
          {name:"Draymond Green",rating:"B",trainedToday:false},
          {name:"Jonathan Kuminga",rating:"B",trainedToday:false},
          {name:"Andrew Wiggins",rating:"B+",trainedToday:false}
        ];
        freeAgents = [
          {name:"Malik Beasley",rating:"B",signChance:60},
          {name:"Robert Covington",rating:"B-",signChance:50}
        ];
        otherTeams = structuredClone(otherTeamData);
      }
    }

    function saveData(){
      localStorage.setItem("sj_gm_data", JSON.stringify({warriors,freeAgents,otherTeams,money,salaryCap,lastSimDate}));
    }

    function renderDate(){
      document.getElementById("dateDisplay").textContent = "ä»Šå¤©ï¼š"+ new Date().toLocaleDateString();
    }

    function calcTeamWage(){
      return warriors.reduce((sum,p)=> sum + ratingMap[p.rating]*baseWage, 0);
    }

    function renderSalary(){
      document.getElementById("salaryInfo").textContent =
        `ğŸ’° åœ˜éšŠå·¥è³‡ï¼š${calcTeamWage()} / ä¸Šé™ï¼š${salaryCap}M`;
    }

    function showWarriors(){
      const c = document.getElementById("team");
      c.innerHTML = "<h2>å‹‡å£«é™£å®¹</h2>";
      warriors.forEach((p,i)=>{
        const star = "â­".repeat(ratingMap[p.rating]);
        const btn = p.trainedToday ?
          `<button class="disabled">è¨“ç·´</button>` :
          `<button onclick="trainPlayer(${i})">è¨“ç·´</button>`;
        c.innerHTML += `
          <div class="player">
            <div class="player-card">${p.name[0]}</div>
            <div><strong>${p.name}</strong> - ${p.rating} ${p.trainedToday?"ï¼ˆå·²è¨“ç·´ï¼‰":""}<br>${star}</div>
            <div class="stats">è–ªè³‡ï¼š${ratingMap[p.rating]*baseWage}M</div>
            ${btn}
          </div>`;
      });
      renderSalary();
    }

    window.trainPlayer = function(i){
      if(warriors[i].trainedToday){ alert("ä»Šæ—¥å·²è¨“ç·´"); return; }
      const list = Object.keys(ratingMap);
      let idx = list.indexOf(warriors[i].rating);
      if(idx < list.length -1){
        warriors[i].rating = list[idx+1];
        warriors[i].trainedToday = true;
        alert(`${warriors[i].name} è©•åƒ¹å‡ç‚º ${warriors[i].rating}ï¼`);
      } else {
        alert("å·²æ˜¯æœ€é«˜ï¼");
      }
      showWarriors();
      saveData();
    }

    function resetTraining(){
      warriors.forEach(p=>p.trainedToday=false);
      alert("ä»Šæ—¥è¨“ç·´é‡ç½®ï¼");
      showWarriors();
      saveData();
    }

    function simulateGameAuto(today){
      let ours=0, opps=0;
      warriors.forEach(p=> ours += ratingMap[p.rating] + Math.random()*5|0 );
      const allOthers = Object.values(otherTeams).flat();
      const opp = allOthers[Math.random()*allOthers.length|0];
      opps = ratingMap[opp.rating] + Math.random()*10|0;
      document.getElementById("gameResult").innerHTML = `
        <h3>æ¯”è³½çµæœ</h3>
        <p>å‹‡å£« ${ours} : ${opps} ${opp.name}</p>
        <p>${ours>opps ? "ğŸ‰ å‹åˆ©ï¼" : "ğŸ’” è½æ•—..."}</p>`;
      lastSimDate = today;
      saveData();
    }

    function showFreeAgents(){
      const c = document.getElementById("freeAgents");
      c.innerHTML = "<h2>è‡ªç”±å¸‚å ´</h2>";
      freeAgents.forEach((p,i)=>{
        const chance = Math.max(5, p.signChance - ratingMap[p.rating]);
        c.innerHTML += `
          <div class="player">
            <div class="player-card">${p.name[0]}</div>
            <div><strong>${p.name}</strong> - ${p.rating}<br>ç°½ç´„ç‡ï¼šç´„${chance}%</div>
            <button onclick="signFreeAgent(${i},${chance})">ç°½ä¸‹</button>
          </div>`;
      });
    }

    window.signFreeAgent = function(i,ch){
      if(Math.random()*100 <= ch){
        warriors.push({...freeAgents[i],trainedToday:false});
        alert(`${freeAgents[i].name} åŠ å…¥è»åœ˜ï¼`);
        freeAgents.splice(i,1);
      } else {
        alert("ç°½ç´„å¤±æ•—...");
      }
      showFreeAgents(); showWarriors();
      saveData();
    }

    function selectTeam(){
      const area = document.getElementById("teamSelectArea");
      area.innerHTML = `
        <h3>é¸éšŠä¼çœ‹é™£å®¹ï¼š</h3>
        <select id="teamSelect"><option value="">è«‹é¸æ“‡</option>
        ${Object.keys(otherTeams).map(t=>`<option value="${t}">${t}</option>`).join("")}
        </select>`;
      document.getElementById("teamSelect").addEventListener("change", e=>showOtherTeam(e.target.value));
    }

    function showOtherTeam(name){
      const c = document.getElementById("otherTeam");
      if(!name){ c.innerHTML=""; return; }
      const arr=otherTeams[name];
      c.innerHTML = `<h2>${name} é™£å®¹</h2>`;
      arr.forEach(p=>{
        c.innerHTML += `
          <div class="player">
            <div class="player-card">${p.name[0]}</div>
            <div><strong>${p.name}</strong> - ${p.rating}<br>â­${ratingMap[p.rating]}</div>
          </div>`;
      });
    }

    document.addEventListener("DOMContentLoaded",()=>{
      loadData(); renderDate(); showWarriors(); showFreeAgents();
      document.getElementById("showWarriorsBtn").onclick = showWarriors;
      document.getElementById("showFreeAgentsBtn").onclick = showFreeAgents;
      document.getElementById("selectTeamBtn").onclick = selectTeam;
      document.getElementById("simulateGameBtn").onclick = ()=>{
        const today = new Date().toLocaleDateString();
        if(lastSimDate===today) return alert("ä»Šå¤©å·²æ¨¡æ“¬éï¼");
        simulateGameAuto(today);
      };
      document.getElementById("resetTrainingBtn").onclick = resetTraining;
      document.getElementById("clearBtn").onclick = ()=>{
        if(confirm("æ¸…é™¤æ‰€æœ‰è³‡æ–™ï¼Ÿ")) localStorage.removeItem("sj_gm_data"), location.reload();
      };
    });
  })();
  </script>
</body>
</html>